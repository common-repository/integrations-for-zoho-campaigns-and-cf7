"use strict";(self.webpackChunk_frm_in=self.webpackChunk_frm_in||[]).push([[937,672],{5672:(e,t,a)=>{a.r(t),a.d(t,{addFieldMap:()=>v,checkWebhookIntegrationsExist:()=>_,delFieldMap:()=>h,handleAuthorize:()=>g,handleCustomValue:()=>w,handleFieldMapping:()=>y,saveActionConf:()=>f,saveIntegConfig:()=>m,setGrantTokenResponse:()=>p});var l=a(8063),n=a(6370),i=a(986),r=a.n(i),o=a(5274),s=a(9542),d=a(3105),u=a(4222),c=["Webhook","KaliForms","Amelia","WPFunnels","Typebot","JetForm","FluentSupport"],_=function(e){return c.includes(e)},m=function(){var e=(0,n.Z)(r().mark((function e(t,a,l,n,i,o,s,c){var m,f,p,g,b,v,h,y,w,I,x,C;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return p="flow/save",c(!0),g=n,"cond"!==(null==n||null==(m=n.condition)?void 0:m.action_behavior)&&(g.condition={action_behavior:"",actions:[{field:"",action:"value"}],logics:[{field:"",logic:"",val:""},"or",{field:"",logic:"",val:""}]}),"Elementor"===t.triggered_entity&&(g.postId=s?null!=(b=null==t||null==(v=t.flow_details)?void 0:v.postId)?b:null:null!=(h=null==t||null==(y=t.triggerData)?void 0:y.postId)?h:null),w={name:n.name,trigger:t.triggered_entity,triggered_entity_id:null!=t&&null!=(f=t.triggerData)&&f.formID?t.triggerData.formID:t.triggered_entity_id||0,flow_details:g},t.id&&(w.id=t.id),_(t.triggered_entity)&&(w.flow_details.fields=s?null==t||null==(x=t.flow_details)?void 0:x.fields:null==t||null==(I=t.triggerDetail)?void 0:I.data),s&&(p="flow/update"),e.prev=9,e.next=12,(0,d.Z)(w,p);case 12:return C=e.sent,!s&&C.success&&i.push(l),c(!1),e.abrupt("return",C);case 18:return e.prev=18,e.t0=e.catch(9),c(!1),e.abrupt("return",(0,u.__)("Failed to save integration"));case 22:case"end":return e.stop()}}),e,null,[[9,18]])})));return function(t,a,l,n,i,r,o,s){return e.apply(this,arguments)}}(),f=function(){var e=(0,n.Z)(r().mark((function e(t){var a,l,n,i,s,c,m,f,p,g,b,v,h,y,w,I;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l=t.flow,t.setFlow,n=t.allIntegURL,i=t.conf,s=t.history,t.index,c=t.edit,m=t.setIsLoading,t.setSnackbar,f="flow/save",m&&m instanceof Function&&m(!0),p=i,"Elementor"===l.triggered_entity&&(p.postId=c?null!=(g=null==l||null==(b=l.flow_details)?void 0:b.postId)?g:null:null!=(v=null==l||null==(h=l.triggerData)?void 0:h.postId)?v:null),y={name:i.name,trigger:l.triggered_entity,triggered_entity_id:null!=l&&null!=(a=l.triggerData)&&a.formID?l.triggerData.formID:l.triggered_entity_id||0,flow_details:p},l.id&&(y.id=l.id),_(l.triggered_entity)&&(y.flow_details.fields=c?null==l||null==(I=l.flow_details)?void 0:I.fields:null==l||null==(w=l.triggerDetail)?void 0:w.data),c&&(f="flow/update"),e.prev=9,e.next=12,(0,d.Z)(y,f).then((function(e){var t;!c&&e.success&&s.push(n);var a="",l="success";null!=(t=e.data)&&t.msg?a=e.data.msg:e.success?a=c?(0,u.__)("Integration updated successfully"):(0,u.__)("Integration saved successfully"):(l="error",a=c?(0,u.__)("Failed to update integration"):(0,u.__)("Failed to save integration")),(0,o.ZP)(a,{type:l}),m&&m instanceof Function&&m(!1),c||setTimeout((function(){s.push(n)}),700)}));case 12:e.next=18;break;case 14:return e.prev=14,e.t0=e.catch(9),m&&m instanceof Function&&m(!1),e.abrupt("return",(0,u.__)("Failed to save integration"));case 18:case"end":return e.stop()}}),e,null,[[9,14]])})));return function(t){return e.apply(this,arguments)}}(),p=function(e){var t={},a=window.location.href.replace(window.opener.location.href+"/redirect","").split("&");a&&a.forEach((function(e){var a=e.split("=");a[1]&&(t[a[0]]=a[1])})),localStorage.setItem("__"+e,JSON.stringify(t)),window.close()},g=function(e,t,a,n,i,r,o,d,c){if(n.dataCenter&&n.clientId&&n.clientSecret){d(!0);var _="https://accounts.zoho."+n.dataCenter+"/oauth/v2/auth?scope="+a+"&response_type=code&client_id="+n.clientId+"&prompt=Consent&access_type=offline&redirect_uri="+encodeURIComponent(null==s.hi?void 0:s.hi.base)+"/redirect&state="+encodeURIComponent(window.location.href)+"/redirect",m=window.open(_,e,"width=400,height=609,toolbar=off"),f=setInterval((function(){if(m.closed){clearInterval(f);var a={},r=!1,s=localStorage.getItem("__"+e);if(s&&(r=!0,a=JSON.parse(s),localStorage.removeItem("__"+e)),a.code&&!a.error&&a&&r){var _=(0,l.Z)({},n);_.accountServer=a["accounts-server"],b(t,a,_,i,o,d,c)}else{var p=a.error?"Cause: "+a.error:"";c({show:!0,msg:(0,u.__)("Authorization failed")+" "+p+". "+(0,u.__)("please try again")}),d(!1)}}}),500)}else r({dataCenter:n.dataCenter?"":(0,u.__)("Data center cann't be empty"),clientId:n.clientId?"":(0,u.__)("Client ID cann't be empty"),clientSecret:n.clientSecret?"":(0,u.__)("Secret key cann't be empty")})},b=function(e,t,a,n,i,r,o){var c=(0,l.Z)({},t);c.dataCenter=a.dataCenter,c.clientId=a.clientId,c.clientSecret=a.clientSecret,c.redirectURI=(null==s.hi?void 0:s.hi.base)+"/redirect",(0,d.Z)(c,e+"_generate_token").then((function(e){return e})).then((function(e){if(e&&e.success){var t=(0,l.Z)({},a);t.tokenDetails=e.data,n(t),i(!0),o({show:!0,msg:(0,u.__)("Authorized Successfully")})}else e&&e.data&&e.data.data||!e.success&&"string"===typeof e.data?o({show:!0,msg:""+(0,u.__)("Authorization failed Cause:")+(e.data.data||e.data)+". "+(0,u.__)("please try again")}):o({show:!0,msg:(0,u.__)("Authorization failed. please try again")});r(!1)}))},v=function(e,t,a,n,i){var r=(0,l.Z)({},t);i?n?r.relatedlists[i-1].upload_field_map.splice(e,0,{}):r.relatedlists[i-1].field_map.splice(e,0,{}):n?r.upload_field_map.splice(e,0,{}):r.field_map.splice(e,0,{}),a((0,l.Z)({},r))},h=function(e,t,a,n,i){var r=(0,l.Z)({},t);i?n?r.relatedlists[i-1].upload_field_map.length>1&&r.relatedlists[i-1].upload_field_map.splice(e,1):r.relatedlists[i-1].field_map.length>1&&r.relatedlists[i-1].field_map.splice(e,1):n?r.upload_field_map.length>1&&r.upload_field_map.splice(e,1):r.field_map.length>1&&r.field_map.splice(e,1),a((0,l.Z)({},r))},y=function(e,t,a,n,i,r){var o=(0,l.Z)({},a);r?i?o.relatedlists[r-1].upload_field_map[t][e.target.name]=e.target.value:o.relatedlists[r-1].field_map[t][e.target.name]=e.target.value:i?o.upload_field_map[t][e.target.name]=e.target.value:o.field_map[t][e.target.name]=e.target.value,"custom"===e.target.value&&(r?o.relatedlists[r-1].field_map[t].customValue="":o.field_map[t].customValue=""),n((0,l.Z)({},o))},w=function(e,t,a,n,i){var r=(0,l.Z)({},a);i?r.relatedlists[i-1].field_map[t].customValue=e.target.value:r.field_map[t].customValue=e.target.value,n((0,l.Z)({},r))}},4937:(e,t,a)=>{a.r(t),a.d(t,{addFieldMap:()=>p,default:()=>g});var l=a(8063),n=a(9892),i=a(3681),r=a(4054),o=a(4222),s=[{name:"_bi_current_time",label:"Current Date Time"},{name:"_bi_admin_email",label:"Administrator Email"},{name:"_bi_date_default",label:"Date (default format)"},{name:"_bi_date.m/d/y",label:"Date(mm/dd/yyy)"},{name:"_bi_date.d/m/y",label:"Date(dd/mm/yyy)"},{name:"_bi_date.y/m/d",label:"Date(Y-m-d)"},{name:"_bi_time",label:"Time"},{name:"_bi_weekday",label:"Weekday"},{name:"_bi_http_referer_url",label:"Referer URL"},{name:"_bi_ip_address",label:"User IP Address"},{name:"_bi_browser_name",label:"User Browser Name"},{name:"_bi_operating_system",label:"User Operating System"},{name:"_bi_random_digit_num",label:"Random Digit Number"},{name:"_bi_user_id",label:"User ID"},{name:"_bi_user_first_name",label:"User First Name"},{name:"_bi_user_last_name",label:"User Last Name"},{name:"_bi_user_display_name",label:"User Display Name"},{name:"_bi_user_nice_name",label:"User Nice Name"},{name:"_bi_user_login_name",label:"User Login Name"},{name:"_bi_user_email",label:"User Email"},{name:"_bi_user_url",label:"User Url"},{name:"_bi_current_user_role",label:"Current User Role"},{name:"_bi_author_id",label:"Post Author ID"},{name:"_bi_author_display",label:"Post Author Display Name"},{name:"_bi_author_email",label:"Post Author Email"},{name:"_bi_site_title",label:"Site Title"},{name:"_bi_site_description",label:"Site Description"},{name:"_bi_site_url",label:"Site URL"},{name:"_bi_wp_local_codes",label:"WordPress Locale Code"},{name:"_bi_post_id",label:"Embedded Page / Post ID"},{name:"_bi_post_name",label:"Embedded Page / Post Name"},{name:"_bi_post_title",label:"Embedded Page / Post Title"},{name:"_bi_post_url",label:"Embedded Page / Post URL"},{name:"_bi_post_date",label:"Post Publish Date"},{name:"_bi_post_modified_date",label:"Post Modified Date"}],d=(a(2709),a(8095)),u=a.n(d),c=(a(9121),a(9496)),_=a(4637);const m=function(e){var t=e.label,a=e.onChange,l=e.value,n=(e.disabled,e.type),i=(e.textarea,e.className,e.formFields),r=i?i.filter((function(e){return void 0!==e.label})).map((function(e){return{name:e.label,value:e.name}})):[],o=(0,c.useRef)(null),s=(0,c.useRef)(null);(0,c.useEffect)((function(){var e=o.current;e.value=l,e.setAttribute("value",l),s.current&&s.current.destroy(),s.current=new(u())(e,g),s.current.DOM.originalInput.value=l,s.current.on("input",m),s.current.on("add",f),s.current.on("remove",p)}),[]);var d=function(e){var t=e.match(/(\${{.*?"value":".*?)"}}/g),l=e;t&&t.forEach((function(e){var t=e.slice(2,-1),a=JSON.parse(t);l=l.replace(e,"${"+a.value+"}")})),a(l)},m=function(e){var t=e.detail,a=t.prefix,l=t.textContent.slice(-1),n="#"===l?l:a;n&&("#"===n&&(s.current.whitelist=r),s.current.dropdown.show()),setTimeout((function(){d(e.detail.tagify.DOM.originalInput.value)}),100)},f=function(e){setTimeout((function(){d(e.detail.tagify.DOM.originalInput.value)}),100)},p=function(e){setTimeout((function(){d(e.detail.tagify.DOM.originalInput.value)}),100)},g={mixTagsInterpolator:["${","}"],mode:"mix",mixMode:{insertAfterTag:" "},pattern:/#/,placeholder:t,tagTextProp:"value",duplicates:!0,whitelist:r,enforceWhitelist:!0,trim:!0,editTags:!1,dropdown:{enabled:0,position:"text",mapValueTo:"value",highlightFirst:!0,searchKeys:["label","value"],closeOnSelect:!0,placeAbove:!1},callbacks:{add:function(){d(s.current.DOM.originalInput.value)},remove:function(){d(s.current.DOM.originalInput.value)}}};return(0,_.jsx)("div",{children:(0,_.jsx)("input",{name:"tagify-inp",type:void 0===n?"text":n,ref:o})})};var f=a(5672),p=function(e,t,a){var n=(0,l.Z)({},t);n.field_map.splice(e,0,{}),a(n)};function g(e){var t,a,d=e.i,u=e.formFields,c=e.field,p=e.campaignsConf,g=e.setCampaignsConf,b=(0,n.sJ)(i.qn).isPro,v=""===c.zohoFormField||-1===(null==(t=p.default.fields[p.list].required)?void 0:t.indexOf(c.zohoFormField)),h=function(e,t){var a=(0,l.Z)({},p);a.field_map[t][e.target.name]=e.target.value,"custom"===e.target.value&&(a.field_map[t].customValue=""),g(a)};return(0,_.jsxs)("div",{className:"flx flx-around mt-2 "+(v&&"mr-1"),children:[(0,_.jsxs)("select",{className:"btcd-paper-inp mr-2",name:"formField",value:c.formField||"",onChange:function(e){return h(e,d)},children:[(0,_.jsx)("option",{value:"",children:(0,o.__)("Select Field","integration-for-zoho-campaigns-and-cf7")}),(0,_.jsx)("optgroup",{label:"Form Fields",children:u.map((function(e){return"file"!==e.type&&(0,_.jsx)("option",{value:e.name,children:e.label},"ff-zhcrm-"+e.name)}))}),(0,_.jsx)("option",{value:"custom",children:(0,o.__)("Custom...","integration-for-zoho-campaigns-and-cf7")}),(0,_.jsx)("optgroup",{label:"General Smart Codes "+(b?"":"(PRO)"),children:b&&(null==s?void 0:s.map((function(e){return(0,_.jsx)("option",{value:e.name,children:e.label},"ff-rm-"+e.name)})))})]}),"custom"===c.formField&&(0,_.jsx)(m,{onChange:function(e){return(0,f.handleCustomValue)(e,d,p,g)},label:(0,o.__)("Custom Value","integration-for-zoho-campaigns-and-cf7"),className:"mr-2",type:"text",value:c.customValue,placeholder:(0,o.__)("Custom Value","integration-for-zoho-campaigns-and-cf7"),formFields:u}),(0,_.jsxs)("select",{className:"btcd-paper-inp",name:"zohoFormField",value:c.zohoFormField||"",disabled:!v,onChange:function(e){return h(e,d)},children:[(0,_.jsx)("option",{value:"",children:(0,o.__)("Select Field","integration-for-zoho-campaigns-and-cf7")}),v?(null==p||null==(a=p.default)||null==(a=a.fields)||null==(a=a[p.list])?void 0:a.fields)&&p.default.fields[p.list].fields.map((function(e){return"Contact Email"!==e&&(0,_.jsx)("option",{value:e,children:e},e+"-1")})):(0,_.jsx)("option",{value:"Contact Email",children:(0,o.__)("Contact Email","integration-for-zoho-campaigns-and-cf7")},"contact_email")]}),v&&(0,_.jsx)("button",{onClick:function(){return function(e){var t=(0,l.Z)({},p);t.field_map.length>1&&t.field_map.splice(e,1),g(t)}(d)},className:"icn-btn sh-sm ml-1",type:"button","aria-label":"btn",children:(0,_.jsx)(r.Z,{})})]})}}}]);